<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="description" content="Kopalnie PrawdopodobieÅ„stwa - Wydobywaj krysztaÅ‚y i buduj swojÄ… mozaikÄ™ szczÄ™Å›cia!" />
    <title>â›ï¸ Kopalnie PrawdopodobieÅ„stwa | Wydobywaj SzczÄ™Å›cie</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800;900&family=Chakra+Petch:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles.css">
  </head>
  <body>
    <!-- Skip link for accessibility -->
    <a href="#game-main" class="skip-link">PrzejdÅº do gry</a>
    
    <!-- Loading Screen -->
    <div id="loading-screen">
      <div class="loader-title">â›ï¸ Kopalnie PrawdopodobieÅ„stwa</div>
      <div class="loader-subtitle">Wydobywaj SzczÄ™Å›cie</div>
      <div class="loader-pickaxe">â›ï¸</div>
      <div class="loader-bar-container">
        <div class="loader-bar" id="loader-bar"></div>
      </div>
      <div class="loader-text" id="loader-text">Przygotowywanie kopalni...</div>
    </div>
    
    <!-- Main Game Wrapper -->
    <div id="game-wrapper">
      <!-- Cave particles -->
      <div class="cave-particles" id="cave-particles"></div>
      
      <!-- Header -->
      <header id="game-header">
        <div class="game-logo">
          <span class="logo-icon" aria-hidden="true">â›ï¸</span>
          <span class="logo-text">Kopalnie</span>
        </div>
        <div class="header-stats">
          <div class="stat-box">
            <div class="stat-value" id="total-crystals" aria-label="Punkty krysztaÅ‚Ã³w">0</div>
            <div class="stat-label">KrysztaÅ‚y</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="player-level" aria-label="Poziom gracza">1</div>
            <div class="stat-label">Poziom</div>
          </div>
        </div>
      </header>
      
      <!-- Main game area -->
      <main id="game-main">
        <!-- Mine depth -->
        <div id="mine-depth">
          <div class="depth-title">ğŸ•³ï¸ GÅ‚Ä™bokoÅ›Ä‡ Kopalni</div>
          <div class="depth-progress" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="100">
            <div class="depth-fill" id="depth-fill" style="width: 5%;"></div>
          </div>
          <div class="depth-label">Poziom <span id="current-depth">1</span> - PÅ‚ytka Kopalnia</div>
        </div>
        
        <!-- Mining grid -->
        <div id="mine-grid-container">
          <div id="mine-grid" role="grid" aria-label="Siatka wydobywcza">
            <!-- Tiles will be generated by JS -->
          </div>
        </div>
        
        <!-- Drill section -->
        <div id="drill-section">
          <button id="drill-btn" disabled aria-label="Wykop losowe pole">
            <span class="drill-icon" aria-hidden="true">â›ï¸</span>
            <span>Kop!</span>
          </button>
          <div class="energy-display" aria-live="polite">
            <span>Energia:</span>
            <div class="energy-bar" id="energy-bar" role="meter" aria-label="Energia gracza">
              <!-- Energy pips generated by JS -->
            </div>
            <span id="energy-text">5/5</span>
          </div>
        </div>
      </main>
      
      <!-- Mosaic section -->
      <section id="mosaic-section" aria-label="Mozaika szczÄ™Å›cia">
        <div class="mosaic-header">
          <div class="mosaic-title">
            <span aria-hidden="true">ğŸ’</span>
            <span>Mozaika SzczÄ™Å›cia</span>
          </div>
          <div class="mosaic-progress-text" aria-live="polite"><span id="mosaic-count">0</span>/21 krysztaÅ‚Ã³w</div>
        </div>
        <div id="mosaic-grid" role="grid" aria-label="Kolekcja krysztaÅ‚Ã³w">
          <!-- Mosaic slots generated by JS -->
        </div>
      </section>
    </div>
    
    <!-- Navigation buttons -->
    <nav class="nav-buttons" aria-label="Nawigacja gÅ‚Ã³wna">
      <button class="nav-btn" id="btn-leaderboard" title="Ranking" aria-label="PokaÅ¼ ranking graczy">
        <span aria-hidden="true">ğŸ†</span>
      </button>
      <button class="nav-btn" id="btn-shop" title="Sklep" aria-label="OtwÃ³rz sklep gÃ³rnika">
        <span aria-hidden="true">ğŸ›’</span>
      </button>
      <button class="nav-btn" id="btn-help" title="Pomoc" aria-label="Pomoc i instrukcje">
        <span aria-hidden="true">â“</span>
      </button>
    </nav>
    
    <!-- Probability toggle button -->
    <button id="prob-toggle-btn" title="PokaÅ¼ szanse" aria-label="PokaÅ¼ panel prawdopodobieÅ„stw">
      <span aria-hidden="true">ğŸ“Š</span>
    </button>
    
    <!-- Probability panel -->
    <div id="probability-panel" role="region" aria-label="Panel prawdopodobieÅ„stw">
      <div class="prob-header">
        <div class="prob-title">ğŸ“Š PrawdopodobieÅ„stwa wydobycia</div>
        <button class="prob-toggle" id="prob-close" aria-label="Zamknij panel">âœ•</button>
      </div>
      <div class="prob-grid">
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸ’</div>
          <div class="prob-percent" id="prob-diamond">0.5%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">â¤ï¸</div>
          <div class="prob-percent" id="prob-ruby">2%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸ’š</div>
          <div class="prob-percent" id="prob-emerald">5%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸ’™</div>
          <div class="prob-percent" id="prob-sapphire">8%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">â­</div>
          <div class="prob-percent" id="prob-gold">10%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸ’œ</div>
          <div class="prob-percent" id="prob-amethyst">15%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸ¤</div>
          <div class="prob-percent" id="prob-quartz">25%</div>
        </div>
        <div class="prob-item">
          <div class="prob-icon" aria-hidden="true">ğŸª¨</div>
          <div class="prob-percent" id="prob-rock">34.5%</div>
        </div>
      </div>
    </div>
    
    <!-- Result popup -->
    <div class="result-popup" id="result-popup">
      <div class="result-crystal" id="result-crystal" aria-hidden="true">ğŸ’</div>
      <div class="result-name" id="result-name">Diament!</div>
      <div class="result-points" id="result-points">+1000 punktÃ³w</div>
      <div class="result-nearwin" id="result-nearwin" style="display: none;">
        ByÅ‚ tak blisko lepszego krysztaÅ‚u!
      </div>
    </div>
    
    <!-- Welcome Modal -->
    <div class="modal-overlay" id="welcome-modal" role="dialog" aria-modal="true" aria-labelledby="welcome-title">
      <div class="modal">
        <div class="modal-icon" aria-hidden="true">â›ï¸</div>
        <h2 id="welcome-title">Witaj w Kopalni!</h2>
        <p>
          Schodzisz do magicznej kopalni peÅ‚nej cennych krysztaÅ‚Ã³w. 
          KaÅ¼de uderzenie kilofa to losowanie â€“ co odkryjesz? 
          Zbieraj krysztaÅ‚y i buduj swojÄ… MozaikÄ™ SzczÄ™Å›cia!
        </p>
        <input type="text" id="player-name" placeholder="TwÃ³j pseudonim gÃ³rnika..." maxlength="20" aria-label="Pseudonim gracza">
        <input type="email" id="player-email" placeholder="E-mail (opcjonalnie - bonus!)" aria-label="Adres email (opcjonalnie)">
        <div class="email-bonus-hint">
          âœ¨ Podaj email i otrzymaj +3 bonusowej energii!
        </div>
        <div style="margin-top: 20px;">
          <button class="btn btn-primary" id="start-game-btn">Rozpocznij Kopanie!</button>
        </div>
        <p class="legal-text">
          Gra dla osÃ³b 18+. Wyniki oparte sÄ… na generatorze liczb losowych (RNG). 
          Wszystkie prawdopodobieÅ„stwa sÄ… transparentne i dostÄ™pne w panelu statystyk.
          Graj odpowiedzialnie.
        </p>
      </div>
    </div>
    
    <!-- Near Win Modal -->
    <div class="modal-overlay" id="nearwin-modal" role="dialog" aria-modal="true" aria-labelledby="nearwin-title">
      <div class="modal">
        <div class="modal-icon" aria-hidden="true">ğŸ”¥</div>
        <h2 id="nearwin-title">ByÅ‚o Tak Blisko!</h2>
        <p id="nearwin-text">
          TwÃ³j kilof prawie trafiÅ‚ na Diament! Tylko centymetry dzieliÅ‚y CiÄ™ od wielkiego odkrycia!
        </p>
        <div style="margin-top: 20px;">
          <button class="btn btn-primary" id="retry-btn">SprÃ³buj Ponownie</button>
          <button class="btn btn-secondary" id="share-btn">UdostÄ™pnij</button>
        </div>
      </div>
    </div>
    
    <!-- Daily Bonus Modal -->
    <div class="modal-overlay" id="daily-modal" role="dialog" aria-modal="true" aria-labelledby="daily-title">
      <div class="modal">
        <div class="modal-icon" aria-hidden="true">ğŸ</div>
        <h2 id="daily-title">Dzienny Bonus!</h2>
        <p>WrÃ³ciÅ‚eÅ› do kopalni! Oto Twoja nagroda:</p>
        <div class="daily-reward-display">
          <div class="reward-crystals" id="daily-reward-crystals" aria-hidden="true">âš¡âš¡âš¡</div>
          <div class="reward-text" id="daily-reward-text">+3 Energia</div>
        </div>
        <div class="streak-display">
          ğŸ”¥ Seria kopania: <strong id="streak-count">1</strong> dni
        </div>
        <div style="margin-top: 20px;">
          <button class="btn btn-primary" id="claim-daily">Odbierz Bonus</button>
        </div>
      </div>
    </div>
    
    <!-- Leaderboard Modal -->
    <div class="modal-overlay" id="leaderboard-modal" role="dialog" aria-modal="true" aria-labelledby="leaderboard-title">
      <div class="modal" style="max-width: 550px;">
        <h2 id="leaderboard-title">ğŸ† Ranking GÃ³rnikÃ³w</h2>
        <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;" role="tablist">
          <button class="tab-btn active" data-tab="daily" role="tab" aria-selected="true">DziÅ›</button>
          <button class="tab-btn" data-tab="weekly" role="tab" aria-selected="false">TydzieÅ„</button>
          <button class="tab-btn" data-tab="alltime" role="tab" aria-selected="false">Wszech czasÃ³w</button>
        </div>
        <div id="leaderboard-list" role="tabpanel" style="max-height: 280px; overflow-y: auto;">
          <!-- Leaderboard entries -->
        </div>
        <div style="margin-top: 20px;">
          <button class="btn btn-secondary" id="close-leaderboard">Zamknij</button>
        </div>
      </div>
    </div>
    
    <!-- Shop Modal -->
    <div class="modal-overlay" id="shop-modal" role="dialog" aria-modal="true" aria-labelledby="shop-title">
      <div class="modal" style="max-width: 500px;">
        <h2 id="shop-title">ğŸ›’ Sklep GÃ³rnika</h2>
        <p>Wzmocnij swojÄ… kopalniÄ™!</p>
        <div style="display: grid; gap: 12px; margin: 20px 0;">
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid rgba(241,196,15,0.2);">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 1.5rem;" aria-hidden="true">âš¡</span>
              <div style="text-align: left;">
                <div style="font-weight: 600;">+5 Energia</div>
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Natychmiastowe doÅ‚adowanie</div>
              </div>
            </div>
            <button class="btn btn-primary" style="padding: 10px 20px; font-size: 0.85rem;" id="buy-energy" aria-label="Kup 5 energii za 5 diamentÃ³w">5 ğŸ’</button>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid rgba(155,89,182,0.2);">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 1.5rem;" aria-hidden="true">ğŸ€</span>
              <div style="text-align: left;">
                <div style="font-weight: 600;">Talizman SzczÄ™Å›cia</div>
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">+10% szans na rzadkie krysztaÅ‚y (10 kopaÅ„)</div>
              </div>
            </div>
            <button class="btn btn-primary" style="padding: 10px 20px; font-size: 0.85rem;" id="buy-luck" aria-label="Kup talizman szczÄ™Å›cia za 15 diamentÃ³w">15 ğŸ’</button>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid rgba(231,76,60,0.2);">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 1.5rem;" aria-hidden="true">ğŸ’¥</span>
              <div style="text-align: left;">
                <div style="font-weight: 600;">Dynamit</div>
                <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">OdsÅ‚oÅ„ 3 pola naraz!</div>
              </div>
            </div>
            <button class="btn btn-primary" style="padding: 10px 20px; font-size: 0.85rem;" id="buy-dynamite" aria-label="Kup dynamit za 10 diamentÃ³w">10 ğŸ’</button>
          </div>
        </div>
        <p style="font-size: 0.75rem; color: rgba(255,255,255,0.4); margin-top: 15px;">
          Diamenty moÅ¼na zdobywaÄ‡ przez grÄ™ lub zakupiÄ‡ w pakietach premium.
        </p>
        <div style="margin-top: 20px;">
          <button class="btn btn-secondary" id="close-shop">Zamknij</button>
        </div>
      </div>
    </div>
    
    <!-- Help Modal -->
    <div class="modal-overlay" id="help-modal" role="dialog" aria-modal="true" aria-labelledby="help-title">
      <div class="modal" style="max-width: 520px;">
        <h2 id="help-title">â“ Jak GraÄ‡?</h2>
        <div style="text-align: left; padding: 15px 0;">
          <div style="margin-bottom: 15px;">
            <strong style="color: var(--crystal-gold);">â›ï¸ Kopanie</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">Kliknij pole na planszy, aby uÅ¼yÄ‡ kilofa. KaÅ¼de kopniÄ™cie zuÅ¼ywa 1 energiÄ™.</p>
          </div>
          <div style="margin-bottom: 15px;">
            <strong style="color: var(--crystal-emerald);">ğŸ’ KrysztaÅ‚y</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">KaÅ¼de pole kryje losowy wynik - od pustej skaÅ‚y po legendarny Diament!</p>
          </div>
          <div style="margin-bottom: 15px;">
            <strong style="color: var(--crystal-amethyst);">ğŸ§© Mozaika</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">Zbieraj krysztaÅ‚y do Mozaiki SzczÄ™Å›cia. UkoÅ„czona mozaika = wielki bonus!</p>
          </div>
          <div style="margin-bottom: 15px;">
            <strong style="color: var(--crystal-ruby);">âš¡ Energia</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">Energia regeneruje siÄ™ co 30 sekund. Wracaj codziennie po bonus!</p>
          </div>
          <div>
            <strong style="color: var(--crystal-sapphire);">ğŸ“Š TransparentnoÅ›Ä‡</strong>
            <p style="font-size: 0.9rem; margin-top: 5px;">Kliknij ğŸ“Š aby zobaczyÄ‡ dokÅ‚adne prawdopodobieÅ„stwa kaÅ¼dego krysztaÅ‚u.</p>
          </div>
        </div>
        <div style="margin-top: 20px;">
          <button class="btn btn-secondary" id="close-help">Rozumiem!</button>
        </div>
      </div>
    </div>
    
    <!-- Mosaic Complete Modal -->
    <div class="modal-overlay" id="mosaic-complete-modal" role="dialog" aria-modal="true" aria-labelledby="mosaic-complete-title">
      <div class="modal">
        <div class="modal-icon" aria-hidden="true">ğŸ‰</div>
        <h2 id="mosaic-complete-title">Mozaika UkoÅ„czona!</h2>
        <p>Gratulacje! ZebraÅ‚eÅ› wszystkie krysztaÅ‚y do Mozaiki SzczÄ™Å›cia!</p>
        <div class="daily-reward-display">
          <div class="reward-crystals" aria-hidden="true">ğŸ’ğŸ’ğŸ’</div>
          <div class="reward-text">+3 Diamenty Bonus!</div>
        </div>
        <p style="font-size: 0.9rem;">Rozpoczynasz nowy poziom kopalni z lepszymi szansami!</p>
        <div style="margin-top: 20px;">
          <button class="btn btn-primary" id="claim-mosaic">Super!</button>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
